<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Snake Retro</title>
    <style>
        body {
            background-color: #000;
            color: #fff;
            margin: 0;
            overflow: hidden;
            text-align: center;
            font-family: Arial, sans-serif;
        }
        #gameArea {
            margin-top: 20px;
            border: 2px solid #555;
            display: inline-block;
        }
        h1 { margin: 10px; color: #0f0; }
        #scoreBoard { font-size: 20px; margin-bottom: 10px; }
        button {
            padding: 15px 30px; font-size: 20px;
            background: #0f0; border: none; cursor: pointer;
            margin-top: 10px;
        }
    </style>
</head>
<body>

    <h1>SNAKE RETRO</h1>
    <div id="scoreBoard">Score Joueur: <span id="pScore">0</span> | Score Robot: <span id="bScore">0</span></div>
    
    <canvas id="gameCanvas" width="800" height="600" style="background:#111;"></canvas>
    
    <br>
    <button onclick="lancerJeu()">JOUER / REJOUER</button>

    <script>
        // CODE A L'ANCIENNE (COMPATIBLE VIEUX MAC)
        var canvas = document.getElementById("gameCanvas");
        var ctx = canvas.getContext("2d");
        
        var GRID = 20;
        var COLS = 40; // 800 / 20
        var ROWS = 30; // 600 / 20
        
        var intervalle;
        var pomme = {x: 10, y: 10};
        
        // Le Joueur
        var joueur = {
            x: 5, y: 5,
            vx: 1, vy: 0,
            corps: [],
            score: 0,
            vivant: true,
            couleur: "#0f0"
        };

        // Le Robot
        var robot = {
            x: 30, y: 20,
            vx: -1, vy: 0,
            corps: [],
            score: 0,
            vivant: true,
            couleur: "#f00"
        };

        function lancerJeu() {
            // Reset
            joueur.x = 5; joueur.y = 5; joueur.vx = 1; joueur.vy = 0;
            joueur.corps = []; joueur.score = 0; joueur.vivant = true;
            
            robot.x = 30; robot.y = 20; robot.vx = -1; robot.vy = 0;
            robot.corps = []; robot.score = 0; robot.vivant = true;
            
            if(intervalle) clearInterval(intervalle);
            intervalle = setInterval(boucleJeu, 100);
        }

        function boucleJeu() {
            // Fond noir
            ctx.fillStyle = "black";
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Pomme
            ctx.fillStyle = "yellow";
            ctx.fillRect(pomme.x * GRID, pomme.y * GRID, GRID-2, GRID-2);
            
            // Mise a jour des serpents
            updateSerpent(joueur, "JOUEUR");
            updateSerpent(robot, "ROBOT");
            
            // Scores
            document.getElementById("pScore").innerText = joueur.score;
            document.getElementById("bScore").innerText = robot.score;
        }

        function updateSerpent(s, type) {
            if(!s.vivant) return;

            // IA du Robot (Logique simple)
            if(type === "ROBOT") {
                if(s.x < pomme.x) { s.vx = 1; s.vy = 0; }
                else if(s.x > pomme.x) { s.vx = -1; s.vy = 0; }
                else if(s.y < pomme.y) { s.vx = 0; s.vy = 1; }
                else if(s.y > pomme.y) { s.vx = 0; s.vy = -1; }
            }

            // Deplacement
            s.x += s.vx;
            s.y += s.vy;

            // Traverser les murs
            if(s.x < 0) s.x = COLS - 1;
            if(s.x >= COLS) s.x = 0;
            if(s.y < 0) s.y = ROWS - 1;
            if(s.y >= ROWS) s.y = 0;

            // Manger pomme
            if(s.x === pomme.x && s.y === pomme.y) {
                s.score++;
                pomme.x = Math.floor(Math.random() * COLS);
                pomme.y = Math.floor(Math.random() * ROWS);
            } else {
                // Retirer la queue si pas mange
                s.corps.shift();
            }

            // Ajouter la tete
            s.corps.push({x: s.x, y: s.y});

            // Dessiner
            ctx.fillStyle = s.couleur;
            for(var i=0; i<s.corps.length; i++) {
                ctx.fillRect(s.corps[i].x * GRID, s.corps[i].y * GRID, GRID-2, GRID-2);
                
                // Collision Soi-meme (Game Over)
                // On ne verifie pas la collision avec la tete elle-meme (le dernier element)
                if(i < s.corps.length - 1) {
                    if(s.x === s.corps[i].x && s.y === s.corps[i].y) {
                        if(type === "JOUEUR") {
                            s.vivant = false;
                            alert("PERDU ! Score: " + s.score);
                            clearInterval(intervalle);
                        } else {
                            // Robot respawn
                            s.corps = [];
                            s.x = Math.floor(Math.random() * COLS);
                            s.y = Math.floor(Math.random() * ROWS);
                        }
                    }
                }
            }
        }

        // Controles Clavier
        window.onkeydown = function(e) {
            switch(e.keyCode) {
                case 37: if(joueur.vx !== 1) { joueur.vx = -1; joueur.vy = 0; } break; // Gauche
                case 38: if(joueur.vy !== 1) { joueur.vx = 0; joueur.vy = -1; } break; // Haut
                case 39: if(joueur.vx !== -1) { joueur.vx = 1; joueur.vy = 0; } break; // Droite
                case 40: if(joueur.vy !== -1) { joueur.vx = 0; joueur.vy = 1; } break; // Bas
            }
        };
    </script>
</body>
</html>
